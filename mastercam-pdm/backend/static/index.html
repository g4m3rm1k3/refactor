<!DOCTYPE html>
<html lang="en" class="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mastercam PDM</title>
    <link rel="stylesheet" href="/static/css/tailwind.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      /* Custom styles can remain here if they are truly global */
    </style>
  </head>

  <body class="app-bg app-text font-sans antialiased">
    <div class="flex flex-col h-screen">
      <header class="flex-shrink-0 header-bg shadow-md z-30">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex items-center justify-between h-16">
            <div class="flex items-center space-x-6">
              <div class="flex items-center space-x-3">
                <i class="fa-solid fa-database text-2xl"></i>
                <h1 class="text-xl font-bold">Mastercam PDM</h1>
              </div>
              <div
                id="connectionStatus"
                class="hidden md:flex items-center space-x-2"
              ></div>
            </div>

            <div class="flex items-center space-x-2">
              <div class="relative hidden sm:block">
                <i
                  class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 opacity-70"
                ></i>
                <input
                  type="text"
                  id="searchInput"
                  placeholder="Search..."
                  class="w-48 lg:w-64 pl-9 pr-10 py-2 text-sm rounded-md"
                />
                <button
                  id="clearSearchBtn"
                  class="absolute right-3 top-1/2 -translate-y-1/2 opacity-70 hover:opacity-100 hidden"
                >
                  <i class="fa-solid fa-xmark"></i>
                </button>
              </div>
              <button id="newFileBtn" class="btn btn-primary">
                <i class="fa-solid fa-plus"></i
                ><span class="hidden lg:inline">New File</span>
              </button>
              <button id="dashboardBtn" class="btn btn-secondary">
                <i class="fa-solid fa-chart-line"></i
                ><span class="hidden lg:inline">Dashboard</span>
              </button>
              <div class="h-6 w-px bg-border-color mx-2"></div>
              <button
                id="configBtn"
                class="btn btn-secondary !px-3"
                title="Settings"
              >
                <i class="fa-solid fa-gear"></i>
              </button>
            </div>
          </div>
        </div>
      </header>

      <main
        class="flex-grow container mx-auto p-4 sm:p-6 lg:p-8 overflow-y-auto"
      >
        <div id="fileList" class="space-y-4">
          <div class="flex justify-center items-center py-24 text-gray-500">
            <div
              class="animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-amber-500"
            ></div>
          </div>
        </div>
      </main>
    </div>

    <div
      id="notification-container"
      class="fixed bottom-4 right-4 z-[1000] w-full max-w-sm space-y-3"
    ></div>

    <template id="file-card-template">
      <div
        class="py-6 px-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-600 hover:shadow-lg transition-shadow"
        data-file-id=""
      >
        <div
          class="flex flex-col md:flex-row md:items-start md:justify-between space-y-4 md:space-y-0"
        >
          <div class="flex-grow">
            <div class="flex items-center space-x-3 mb-2 flex-wrap">
              <h4
                class="text-lg font-semibold text-gray-900 dark:text-white"
                data-field="filename"
              ></h4>
              <span
                class="text-xs font-semibold px-2.5 py-1 rounded-full"
                data-field="revision"
              ></span>
              <span
                class="text-xs font-semibold px-2.5 py-1 rounded-full"
                data-field="status"
              ></span>
            </div>
            <p
              class="italic text-gray-700 dark:text-gray-300 text-sm mb-3"
              data-field="description"
            ></p>
            <div
              class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400"
            >
              <div
                class="flex items-center space-x-2"
                data-field="size-container"
              >
                <i class="fa-solid fa-hard-drive"></i
                ><span data-field="size"></span>
              </div>
              <div class="flex items-center space-x-2">
                <i class="fa-solid fa-clock"></i
                ><span data-field="modified_at"></span>
              </div>
            </div>
            <div
              class="flex items-center space-x-2 text-sm mt-2"
              data-field="lock-info"
            ></div>
          </div>
          <div
            class="flex items-center space-x-2 flex-wrap"
            data-field="action-buttons"
          ></div>
        </div>
      </div>
    </template>

    <template id="template-checkin-modal">
      <div class="panel-bg rounded-xl shadow-lg p-6 w-full max-w-lg">
        <form id="checkinForm">
          <h3 id="checkinModalTitle" class="text-xl font-semibold mb-4">
            Check In File
          </h3>
          <div class="mb-4">
            <label for="commitMessage" class="block text-sm font-medium mb-1"
              >Describe your changes:</label
            >
            <textarea
              id="commitMessage"
              name="commitMessage"
              rows="3"
              required
              class="input-field"
            ></textarea>
          </div>
          <div class="mb-4">
            <label
              for="checkinFileUpload"
              class="block text-sm font-medium mb-1"
              >Upload the updated file:</label
            >
            <input
              id="checkinFileUpload"
              name="file"
              type="file"
              required
              class="w-full text-sm"
            />
          </div>
          <div class="flex justify-end space-x-3">
            <button type="button" class="btn btn-secondary" data-action="close">
              Cancel
            </button>
            <button type="submit" class="btn btn-info">Submit Check-in</button>
          </div>
        </form>
      </div>
    </template>

    <template id="template-new-upload-modal">
      <div class="panel-bg rounded-xl shadow-lg p-6 w-full max-w-lg">
        <form id="newUploadForm" class="space-y-4" novalidate>
          <h3 class="text-xl font-semibold mb-2">Add New File or Link</h3>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <input
                type="radio"
                id="uploadTypeFile"
                name="uploadType"
                value="file"
                class="hidden peer"
                checked
              />
              <label
                for="uploadTypeFile"
                class="block p-3 text-center rounded-lg border-2 cursor-pointer peer-checked:border-accent peer-checked:text-accent"
              >
                <i class="fa-solid fa-file-arrow-up text-xl mb-1"></i>
                <div class="font-semibold">Upload File</div>
              </label>
            </div>
            <div>
              <input
                type="radio"
                id="uploadTypeLink"
                name="uploadType"
                value="link"
                class="hidden peer"
              />
              <label
                for="uploadTypeLink"
                class="block p-3 text-center rounded-lg border-2 cursor-pointer peer-checked:border-accent peer-checked:text-accent"
              >
                <i class="fa-solid fa-link text-xl mb-1"></i>
                <div class="font-semibold">Create Link</div>
              </label>
            </div>
          </div>
          <div class="flex justify-end space-x-3 pt-4">
            <button type="button" class="btn btn-secondary" data-action="close">
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">Create</button>
          </div>
        </form>
      </div>
    </template>

    <template id="template-dashboard-modal">
      <div
        class="panel-bg rounded-xl shadow-lg w-full max-w-4xl flex flex-col max-h-[90vh]"
      >
        <div
          class="flex-shrink-0 flex justify-between items-center p-6 pb-4 border-b"
        >
          <h3 class="text-xl font-semibold">
            <i class="fa-solid fa-chart-line mr-2"></i>Activity Dashboard
          </h3>
          <button class="text-gray-500" data-action="close">
            <i class="fa-solid fa-xmark text-2xl"></i>
          </button>
        </div>
        <div
          id="dashboardContent"
          class="flex-grow min-h-0 p-6 flex flex-col md:flex-row md:space-x-6"
        ></div>
      </div>
    </template>

    <template id="template-config-panel">
      <div
        class="fixed inset-y-0 right-0 w-full max-w-md transform translate-x-full transition-transform duration-300 panel-bg shadow-lg p-6 z-50 overflow-y-auto"
      >
        <div class="flex justify-between items-center pb-4 mb-4 border-b">
          <h3 class="text-2xl font-semibold">Settings</h3>
          <button data-action="close">
            <i class="fa-solid fa-xmark text-2xl"></i>
          </button>
        </div>
      </div>
    </template>

    <script src="/static/js/main.js" type="module"></script>
  </body>
</html>
